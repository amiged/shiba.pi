Tue Aug 29 19:30:01 JST 2023
//Time-stamp: <2006-09-07 13:45:14 hamada>
//Copyright(c) 2000-2006 by Tsuyoshi Hamada. All rights reserved.

/**
   This code was generated by mkcode.pl with tmpN1000.csv vecter file.
*/

#include <stdio.h>   // fopen()
#include <string.h>  // strtok(), strcpy()
#include <stdlib.h>  // atof(), exit()
#include "nbodysim.h" 

void init_particles(char* fname,
		    int* npar,
		    double mass[],
		    double posi[][DIM],
		    double veloc[][DIM])
{
  int idx,n;
  char line[2560];
  FILE *fp;
  fp = fopen(fname,"r");
  idx=0;

  { // get N (number of particles)
    char* p;
    fgets(line,100,fp);
    p = (char* )strtok(line,"\n");
    sscanf(p,"%d",&n);
    *npar = n;
  }

  // get all data
  for(idx=0;idx<n;idx++){
    char* p;
    char col[10][400];
    int i=0;
    if(fgets(line,300,fp)==NULL){printf("Error at loading logfiles\n");exit(0);}
    p = (char* )strtok(line,"\t");
    strcpy(col[i],p);
    i++;
    while((p = (char* )strtok(NULL, "\t"))!=NULL){
      strcpy(col[i],p);
      i++;
    }
    //--- for debug ---
    //    for(i=0;i<7;i++) printf("[%s]",col[i]);
    //    printf("\n");

    mass[idx]=atof(col[0]);
    posi[idx][0]=atof(col[1]);
    posi[idx][1]=atof(col[2]);
    posi[idx][2]=atof(col[3]);
    veloc[idx][0]=atof(col[4]);
    veloc[idx][1]=atof(col[5]);
    veloc[idx][2]=atof(col[6]);
  }
  fclose(fp);
}
